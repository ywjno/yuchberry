= Weibo模块的配置和使用 =
<wiki:toc max_depth="3" />
   在1.1.715（不含）之后的YuchBerry版本中，除了改进之前的PushMail功能之外，还集中开发了统一Weibo的模块。原因没什么，只是想做，不为别的。

   现在写这篇文档的时候YuchWeibo还没有发布，即便是过阵子发布了，这篇文档也有可能在今后的修复开发中，和实际的产品不一致——要知道，我只有一双手，十个指头，难免会有偏差，敬请谅解。

 == 服务端配置 ==
   直到我写这篇文档的时候，仅仅集成了 Sina Weibo 和 T Weibo，今后可能会加入更多的Weibo进来，但是配置几乎是相同的，正所谓“天下武功出少林”，这个道理在Weibo界也是相同的——大家都是使用的xAuth来授权，所以只介绍Sina Weibo的配置。
  === 获得授权码 ===
    在服务器发行版本里面有一个名为 weiboTool_sina.bat 的文件，双击它，会出现下面的界面。GNU/Linux下面需要有 XWindow 的支持。<br />
    [http://i.imgur.com/lJ3xr.jpg]<br />
    点击 * 请求授权* 按钮，会使用系统默认浏览器打开一个页面，就是Weibo的应用授权页面，如下所示<br />
    [http://i.imgur.com/zMTMb.jpg]<br />
    此时需要登陆相应的帐号，就能获得一个授权PIN码，并把这个授权PIN码，把这个PIN码复制到工具的相应位置上如图：注意，如果之前有登录过Weibo帐号，并且有缓存，可能需要 *先退出一下之前的帐号，清空一下cookies才行* <br />
    [http://i.imgur.com/RS3aj.jpg]<br />
    点击 *生产令牌* 按钮，出现授权码，如下：<br />
    [http://i.imgur.com/YhUpF.jpg]<br />


  === 填写config.xml配置文件 ===
   * <b>配置Tag</b>
    通过上面获得 *访问令牌* 之后，就可以填写 config.xml 配置文件了，新加了一组以   *WeiboAccount* 的Tag，里面通过 *type* 属性来区分类型，现在有 *sina* *twitter* 两种类型，之后可能会加入更多的Weibo Type。上面获得的令牌（Token）填写如下：
    {{{
<?xml version="1.0" encoding="UTF-8"?>
<Yuchberry userPassword="111111" serverPort="9716" pushInterval="10" userSSL="0" convertoSimpleChar="0" >

       ...

      <WeiboAccount
		type="sina"
		account="yuchberry_test"		
		accessToken="8a2bf4e5a97194a1eb73740b44******"
		secretToken="7529265879f3c97af609c694064bbc59"
		
		
		timelineSum="20"
		directMessageSum="5"
		atMeSum="5"
		commentSum="5"
	/>
       ...
/>
    }}}
    config.xml 主要属性配置（推送端口、轮训间隔等等），和PushMail配置在[fill_config_ini 这里]。<br />
    <b>极度注意:</b> 这里的从理论上来讲，YuchBerry支持多个相同的 *SinaWeiboAccount* 标签（也就是说推送多个SinaWeibo账户），但是在真正使用的时候，比如回复、转发、评论等等会有一些意想不到的误解，所以不建议使用多个相同 *WeiboAccount* 标签。<br />
   * <b>配置Tag 属性</b>
    解释一下标签里面的属性的含义：<br>
     * *timelineSum*      主页
     * *directMessageSum* 私信
     * *atMeSum*          @到我的
     * *commentSum*       评论到我的
    YuchBerry的机制永远不会改变：服务器轮训，及时推送到客户端（原理视频在[http://code.google.com/p/yuchberry/wiki/FAQ#原理解说视频 这里]）。但是由于Weibo的特殊性：主页Weibo数量较多，回复、评论到我的Weibo对于每一个人来说又不一样，又要保证手机端达到省电、省流量的目的，还要保证Weibo快捷的推送到，于是使用一种算法来实施这个特殊的Weibo推送：<br>
     <b>推送时机 ：轮训次数 + Weibo数量 >= Sum属性的值</b><br>
    举个例子，如果设置 timelineSum="20"，当前已经轮训3次，只有累计Weibo达到或者超过 17个的时候，才能触发一次推送，把17个Weibo集中起来，压缩，一次性推送给客户端；否则，继续轮训，直到它们的和超过指定的 Sum 值。<br />
    当然，还有一个普遍规律适用：* 如果你弄不清楚什么意思，那就是用默认的值吧* 。

 == 配置客户端 ==
    打开客户端Weibo模块很简单，在 *高级设置* 里面勾选中* 开启Weibo模块* ，就可以开启了。开启后，在*YuchBerry 账户状态* 的界面中就会有*Weibo* 的菜单选贤点击就可以打开Weibo管理界面。<br />
    [http://i.imgur.com/hKBAo.png][http://i.imgur.com/29Km5.png]
    [http://i.imgur.com/UA81v.png][http://i.imgur.com/3b5qm.png]<br />
    * <b>开启Weibo模块</b>
     启用后，weibo模块就开启，进入YuchBerry的首次界面就不是*YuchBerry 账户状态* 了，而是Weibo界面，需要通过菜单才能进入 *YuchBerry 账户状态* 。
    * <b>转发/评论后同时发一条Weibo</b>
    * <b>回复后同时发一条Weibo</b>
     Sina Weibo等国内Weibo对于这条选项来说有用，T Weibo所以的转发、回复都会在自己Timeline上发一条Weibo
    * <b>优先显示评论原始内容</b>
     Sina Weibo等国内Weibo对于这条选项来说有用，就是把原始内容优先显示，再显示评论的内容，方便黑莓屏幕查看，不然首先看到评论，但是不知道他评论的是什么，心里有些纳闷。
    * <b>跨Weibo转发</b>
     这个会在你转发、评论一条微博的时候，在自己所有的推送Weibo账户上显示出来，比如你在 T Weibo 上看到一个好笑的笑话，转发一下，那么你在 Sina Weibo 的推送账户上也会出现这条Weibo的内容。
  ===快捷键===
     由于屏幕的限制，Weibo查看有一定的限制，使用快捷键会大大加快查看、发表Weibo的速度。
     * <b>T</b> 快速回到最顶端
     * <b>空格</b> 在查看Weibo状态下，迅速查看下一个Weibo
     * <b>Shift+空格</b> 在查看Weibo状态下，迅速查看上一个Weibo
     * <b>F</b> 在查看Weibo状态下，转发
     * <b>E</b> 在查看Weibo状态下，@博主
     * <b>V</b> 在查看Weibo状态下，收藏
     * <b>P</b> 在查看Weibo状态下，查看图片

    